# 🎥 유튜브 크롤러 및 데이터 분석 서비스 (since 2025)

유튜브에서 특정 키워드로 영상을 검색하고, 영상 정보와 댓글을 수집하여 엑셀 형태로 정리하고 **키워드 분석 및 감정 분석**을 제공하는 고성능 서비스입니다.

## ✨ 주요 기능

### 🔍 **핵심 기능**
- **키워드 검색**: 1~5개의 키워드로 유튜브 영상 검색
- **영상 ID 댓글 추출**: 특정 영상 ID로 직접 댓글 수집 (독립적인 탭)
- **날짜 필터링**: 시작 날짜와 종료 날짜를 설정하여 특정 기간의 영상만 수집
- **데이터 수집**: 영상 제목, 채널명, 조회수, 업로드 시간, URL, 발행일 등
- **댓글 수집**: 선택적으로 영상 댓글 수집 (배치 처리로 최적화)
- **추가 댓글 추출**: 크롤링 결과 미리보기 내에서 추가 영상의 댓글 추출
- **엑셀 저장**: 수집된 데이터를 다양한 인코딩으로 엑셀 파일 저장

### 🧠 **AI 분석 기능** (NEW!)
- **키워드 분석**: 댓글에서 주요 키워드 추출 (한국어 형태소 분석)
- **감정 분석**: 댓글의 감정 점수 분석 (긍정/부정/중립)
- **데이터 시각화**: 분석 결과를 차트와 그래프로 시각화
- **성능 메트릭**: 크롤링 성능 및 통계 정보 제공

### 🎨 **2025년 디자인 트렌드** (NEW!)
- **글래스모피즘**: 반투명 배경과 블러 효과
- **네오모피즘**: 부드러운 그림자와 입체감
- **미니멀리즘**: 깔끔하고 직관적인 인터페이스
- **반응형 디자인**: 모든 디바이스에서 최적화된 경험

### ⚡ **성능 최적화** (NEW!)
- **비동기 처리**: 동시 처리로 크롤링 속도 향상
- **캐싱 시스템**: 중복 요청 방지 및 성능 향상
- **재시도 메커니즘**: 안정적인 데이터 수집
- **메모리 최적화**: 대용량 데이터 처리 최적화
- **시스템 모니터링**: 실시간 성능 추적 및 최적화
- **스마트 캐시**: 100MB 자동 캐시 관리
- **히스토리 관리**: 다운로드 기록 추적 및 관리
- **크롤링 제어**: 중단/재시작 기능으로 완전한 크롤링 제어
- **탭 독립성**: 각 탭이 독립적으로 작동하여 안정성 향상

## 🚀 설치 및 실행

### 1. 환경 설정

```bash
# 프로젝트 디렉토리로 이동
cd youtube_crawler

# 가상환경 생성 (권장)
python -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate  # Windows

# 필요한 패키지 설치
pip install -r requirements.txt

# 추가 시스템 모니터링 패키지 (자동 설치됨)
# psutil: 시스템 리소스 모니터링
```

### 2. Chrome 브라우저 설치

이 서비스는 Chrome 브라우저를 사용합니다. Chrome이 설치되어 있지 않다면 [Chrome 다운로드](https://www.google.com/chrome/)에서 설치해주세요.

### 3. 실행 방법

#### 방법 1: 웹 인터페이스 (권장)

```bash
streamlit run app.py
```

브라우저에서 `http://localhost:8501`로 접속하여 사용하세요.

#### 방법 2: 최적화된 테스트 실행

```bash
# 최적화된 테스트 스크립트 실행
python test_optimized.py

# 또는 쉘 스크립트 사용
./run_optimized.sh
```

#### 방법 3: 명령줄 인터페이스

```bash
python main.py
```

## 📖 사용법

### 웹 인터페이스 사용법

#### 🎯 키워드 기반 크롤링 탭
1. **키워드 입력**: 1~5개의 키워드를 입력 (동적으로 키워드 개수 선택 가능)
2. **수집 설정**: 
   - 키워드당 수집할 영상 수 설정 (1~50개)
   - 댓글 수집 여부 선택
   - 영상당 수집할 댓글 수 설정 (1~100개)
   - 날짜 범위 설정 (시작/종료 날짜)
3. **고급 설정**:
   - 키워드 분석 활성화/비활성화
   - 엑셀 인코딩 선택 (utf-8-sig, utf-8, cp949)
   - 동시 처리 수 설정 (1~8개)
4. **크롤링 실행**: "크롤링 시작" 버튼 클릭
5. **크롤링 제어**: "크롤링 중단" 버튼으로 언제든지 중단 가능
6. **결과 확인**: 수집된 데이터를 테이블과 차트로 확인
7. **추가 댓글 추출**: 결과 미리보기에서 추가 영상 ID 입력으로 댓글 추출
8. **분석 결과**: 키워드 분석 및 감정 분석 결과 확인
9. **파일 다운로드**: 엑셀 파일 다운로드
10. **성능 모니터링**: 시스템 상태 및 성능 요약 확인
11. **히스토리 관리**: 다운로드 기록 조회 및 관리

#### 💬 영상 ID 댓글 추출 탭
1. **영상 ID 입력**: 단일 영상 ID 또는 여러 영상 ID 한 번에 입력
2. **댓글 수집 설정**: 영상당 댓글 수 및 키워드 분석 설정
3. **댓글 추출 실행**: "댓글 추출 시작" 버튼 클릭
4. **결과 확인**: 댓글 데이터와 키워드 분석 결과 확인
5. **파일 다운로드**: CSV, Excel, 분석 포함 Excel 등 다양한 형식으로 다운로드

### 명령줄 사용법

1. 프로그램 실행: `python main.py`
2. 키워드 입력: 쉼표로 구분하여 1~5개 입력
3. 설정 입력: 영상 수, 댓글 수집 여부 등
4. 날짜 범위 설정: YYYY-MM-DD 형식으로 시작 날짜와 종료 날짜 입력 (선택사항)
5. 자동 실행: 크롤링이 자동으로 진행됨

## 📊 수집되는 데이터

### 영상 정보
- **키워드**: 검색에 사용된 키워드
- **제목**: 영상 제목
- **채널명**: 업로드한 채널명
- **조회수**: 영상 조회수
- **업로드 시간**: 업로드된 시간 (날짜 필터링에 사용)
- **발행일**: 파싱된 업로드 날짜 (YYYY-MM-DD 형식)
- **URL**: 영상 링크
- **영상 ID**: 유튜브 영상 고유 ID

### 댓글 정보 (선택사항)
- **영상 ID**: 댓글이 달린 영상 ID
- **댓글 내용**: 댓글 텍스트
- **댓글 순서**: 수집된 순서

### 분석 데이터 (NEW!)
- **키워드 분석**: 댓글에서 추출된 주요 키워드
- **감정 분석**: 댓글의 감정 점수 및 분류
- **성능 메트릭**: 크롤링 성능 통계

## 📁 출력 파일

- **엑셀 파일**: `.xlsx` 형식으로 저장 (다양한 인코딩 지원)
- **시트 구성**:
  - `Videos`: 영상 정보 (발행일 포함)
  - `Comments`: 댓글 정보 (댓글 수집 시)
  - `Keyword_Analysis`: 키워드 분석 결과 (키워드 분석 시)
  - `Sentiment_Analysis`: 감정 분석 결과 (키워드 분석 시)
  - `Performance_Metrics`: 성능 통계 정보

## ⚡ 성능 최적화 기능

### 🚀 **비동기 처리**
- 동시에 여러 키워드 검색 처리
- 병렬 댓글 수집으로 속도 향상
- 배치 처리로 메모리 효율성 개선

### 💾 **캐싱 시스템**
- 중복 요청 방지
- 12시간 캐시 유효기간
- 메모리 및 파일 기반 캐싱

### 🔄 **재시도 메커니즘**
- 네트워크 오류 자동 재시도
- WebDriver 오류 복구
- 안정적인 데이터 수집 보장

### 📊 **성능 모니터링**
- 실행 시간 측정
- 메모리 사용량 추적
- 성공/실패율 통계

### 🔧 **시스템 모니터링** (NEW!)
- 실시간 메모리/CPU 사용량 모니터링
- 성능 요약 대시보드
- 작업별 실행 시간 분석
- 메모리 정리 기능

### 🧠 **스마트 캐시** (NEW!)
- 중복 크롤링 방지
- 100MB 자동 캐시 관리
- 오래된 캐시 파일 자동 정리
- 캐시 키 기반 고유 식별

### 📋 **히스토리 관리** (NEW!)
- 파일 다운로드 기록 자동 저장
- 다운로드 히스토리 조회 및 관리
- 파일 크기, 레코드 수, 다운로드 시간 추적
- 히스토리 삭제 기능

## 🧠 AI 분석 기능

### 🔍 **키워드 분석**
- **한국어 형태소 분석**: KoNLPy의 Okt 사용
- **불용어 필터링**: 일반적인 단어 제거
- **키워드 빈도 분석**: 가장 많이 언급된 키워드 추출

### 😊 **감정 분석**
- **TextBlob 기반**: 영어 댓글 감정 분석
- **감정 점수**: -1 (부정) ~ 1 (긍정)
- **감정 분류**: 긍정/부정/중립으로 분류

## 🎨 2025년 디자인 트렌드

### ✨ **글래스모피즘**
- 반투명 배경과 블러 효과
- 투명 테두리로 깊이감 표현
- 현대적이고 세련된 외관

### 🎯 **네오모피즘**
- 부드러운 그림자와 입체감
- 3D 효과로 버튼과 카드 표현
- 압박감 있는 호버 상태

### 📱 **반응형 디자인**
- 모든 디바이스 최적화
- 터치 친화적 인터페이스
- 유연한 레이아웃 시스템

## ⚠️ 주의사항

1. **사용 제한**: 유튜브의 이용약관을 준수하여 적절한 간격으로 요청을 보냅니다.
2. **브라우저**: Chrome 브라우저가 필요합니다.
3. **인터넷 연결**: 안정적인 인터넷 연결이 필요합니다.
4. **데이터 용량**: 대량의 데이터 수집 시 시간이 오래 걸릴 수 있습니다.
5. **메모리 사용**: 키워드 분석 시 추가 메모리가 필요할 수 있습니다.

## 🔧 문제 해결

### Chrome 드라이버 오류
```bash
# Chrome 드라이버 재설치
pip install --upgrade webdriver-manager
```

### 패키지 설치 오류
```bash
# pip 업그레이드
pip install --upgrade pip

# 패키지 재설치
pip install -r requirements.txt --force-reinstall
```

### 메모리 부족 오류
- 수집할 영상 수를 줄여보세요
- 댓글 수집을 비활성화해보세요
- 동시 처리 수를 줄여보세요

### 키워드 분석 오류
```bash
# KoNLPy 관련 패키지 설치
pip install konlpy
pip install textblob
```

## 📈 데이터 분석 기능

웹 인터페이스에서는 다음과 같은 분석 기능을 제공합니다:

### 📊 **기본 분석**
- 키워드별 영상 수
- 인기 채널 분석
- 키워드별 평균 조회수
- 시간대별 업로드 분포

### 🧠 **AI 분석** (NEW!)
- 댓글 키워드 클라우드
- 감정 분석 결과 시각화
- 키워드별 감정 분포
- 성능 메트릭 대시보드

## 🛠️ 고급 설정

### ⚙️ **성능 설정**
- **동시 처리 수**: 1~8개 (기본값: 4)
- **댓글 배치 크기**: 메모리 최적화
- **캐시 유효기간**: 12시간 (기본값)
- **캐시 크기 제한**: 100MB (자동 관리)
- **메모리 정리**: 수동 가비지 컬렉션

### 📝 **출력 설정**
- **엑셀 인코딩**: utf-8-sig, utf-8, cp949
- **키워드 분석**: 활성화/비활성화
- **성능 메트릭**: 포함/제외
- **히스토리 관리**: 최대 50개 기록 유지
- **파일 형식**: XLSX, CSV 선택 가능

## 🤝 기여하기

버그 리포트나 기능 제안은 이슈를 통해 해주세요.

## 📄 라이선스

이 프로젝트는 교육 및 개인 사용 목적으로 제작되었습니다. 상업적 사용 시 유튜브의 이용약관을 확인해주세요.

## 🔗 관련 링크

- [Selenium 공식 문서](https://selenium-python.readthedocs.io/)
- [Streamlit 공식 문서](https://docs.streamlit.io/)
- [Pandas 공식 문서](https://pandas.pydata.org/docs/)
- [KoNLPy 공식 문서](https://konlpy.org/)
- [TextBlob 공식 문서](https://textblob.readthedocs.io/)
- [YouTube Data API](https://developers.google.com/youtube/v3)

## 📋 업데이트 로그

### 2025년 1월 - 크롤링 결과 미리보기 기능 강화
- ✅ **추가 댓글 추출 기능**: 크롤링 결과 미리보기 내에서 영상 ID 입력으로 추가 댓글 추출
- ✅ **데이터 통합 관리**: 기존 댓글 목록에 새로운 댓글 자동 추가 및 통합
- ✅ **실시간 댓글 추가**: 크롤링 완료 후 추가 영상의 댓글도 쉽게 추출 가능
- ✅ **직관적인 인터페이스**: 댓글 목록 탭 내에서 직접 추가 댓글 추출 기능 제공

### 2025년 1월 - 크롤링 중단/재시작 기능 구현
- ✅ **크롤링 중단 버튼**: 진행 중인 크롤링을 언제든지 중단 가능
- ✅ **크롤링 재시작 기능**: 크롤링 완료 후 재시작 버튼으로 다시 시작 가능
- ✅ **동적 버튼 관리**: 크롤링 상태에 따른 버튼 텍스트 변경 (시작 → 재시작)
- ✅ **안전한 상태 관리**: 크롤링 중단 시 안전한 상태 초기화 및 완료 시 자동 업데이트

### 2025년 1월 - 탭 독립성 완전 구현
- ✅ **탭별 독립적 운영**: 영상 ID 댓글 추출 탭이 키워드 기반 크롤링 탭에 의존하지 않음
- ✅ **return 문 제거**: 첫 번째 탭의 키워드 검증에서 return 문을 pass로 변경하여 전체 앱 중단 방지
- ✅ **조건부 버튼 활성화**: 키워드가 없을 때 크롤링 버튼 비활성화로 사용자 경험 개선
- ✅ **완전한 탭 독립성**: 각 탭이 독립적으로 작동하며 탭 간 간섭 완전 제거

### 2025년 1월 - Streamlit UI 오류 해결
- ✅ **StreamlitDuplicateElementId 오류 수정**: 중복된 UI 요소 ID 문제 해결
- ✅ **체크박스 라벨 분리**: "키워드 분석" → "영상 키워드 분석" / "댓글 키워드 분석"으로 분리
- ✅ **세션 상태 관리 개선**: 키워드 분석 설정의 올바른 세션 상태 저장 및 복원
- ✅ **데이터 초기화 로직 강화**: 댓글 데이터 초기화 시 모든 관련 세션 상태 변수 정리

### 2025년 1월 - 영상 ID 댓글 추출 기능 추가
- ✅ **영상 ID 댓글 추출 탭**: 키워드 기반 크롤링과 별도의 독립적인 탭으로 구현
- ✅ **단일/다중 영상 ID 입력**: 단일 영상 ID 또는 여러 영상 ID 한 번에 입력 가능
- ✅ **키워드 분석 통합**: 댓글 추출 시 키워드 분석 및 감정 분석 기능 제공
- ✅ **결과 시각화**: 댓글 데이터와 키워드 분석 결과를 탭으로 분리하여 표시
- ✅ **파일 다운로드 옵션**: CSV, Excel, 분석 포함 Excel 등 다양한 다운로드 옵션

### 2025년 1월 - 성능 테스트 및 최적화
- ✅ **성능 테스트 스크립트**: `performance_test.py`로 시스템 초기화, 검색, 댓글 수집 성능 테스트
- ✅ **성능 테스트 리포트**: 마크다운 및 JSON 형태의 상세한 성능 테스트 결과 생성
- ✅ **최적화 권장사항**: 캐시 활용, 메모리 정리, 동시 처리 수 조정 등 단계별 최적화 적용
- ✅ **네트워크 최적화**: Chrome 드라이버 네트워크 설정 최적화로 지연 시간 단축

### 2025년 1월 - 성능 고도화 및 최적화 업데이트
- ✅ **시스템 점검 및 성능 모니터링**: 실시간 메모리/CPU 사용량 모니터링, 성능 요약 대시보드
- ✅ **캐시 관리 시스템**: 스마트 캐시로 중복 크롤링 방지, 100MB 자동 캐시 관리
- ✅ **다운로드 히스토리 관리**: 파일 다운로드 기록 자동 저장, 히스토리 조회 및 관리
- ✅ **성능 최적화**: 메모리 사용량 최적화, 캐시를 통한 응답 속도 향상
- ✅ **안정성 개선**: 오류 처리 강화, 로깅 시스템 추가, 시스템 상태 실시간 모니터링

### 2025년 1월 - 댓글 수집 문제 해결
- ✅ **댓글 수집 기본값 변경**: False → True로 변경하여 기본 활성화
- ✅ **댓글 수집 과정 상세 로깅**: 영상별 수집 진행 상황 및 오류 정보 표시
- ✅ **오류 정보 상세화**: 댓글 수집 실패 시 expander로 상세 오류 정보 제공
- ✅ **결과 미리보기 개선**: 댓글 데이터 디버깅 정보 및 샘플 데이터 표시
- ✅ **세션 상태 저장 확인**: 크롤링 완료 후 수집 결과 요약 및 저장 확인

### 2025년 1월 - UI/UX 개선
- ✅ **크롤링 진행 과정 콤팩트화**: % + 인터랙티브 바만 표시하여 간소화
- ✅ **결과 미리보기 영역 별도 생성**: 상위 10개 데이터만 표시하여 성능 최적화
- ✅ **파일 다운로드 옵션 개선**: XLSX/CSV 선택 가능, 새로고침 버튼 추가
- ✅ **데이터 지속성 확보**: 파일 다운로드 후에도 크롤링 결과 유지
- ✅ **데이터 초기화 기능**: 수동 데이터 삭제 기능 추가

### 2025년 1월 - Comments 시트 개선
- ✅ **키워드 컬럼 추가**: Comment 컬럼 옆에 추출된 키워드(5개) 컬럼 추가
- ✅ **키워드 포맷팅**: 최대 5개 키워드만 표시하도록 제한
- ✅ **데이터 구조 개선**: 댓글과 키워드를 함께 표시하는 효율적인 구조

### 2025년 1월 - Java/JVM 환경 문제 해결
- ✅ **packages.txt 업데이트**: Java 환경 추가
- ✅ **대체 키워드 추출 로직**: Java 환경 문제 시 기본 키워드 추출 로직 강화
- ✅ **오류 처리 개선**: JVM 관련 오류 시 대체 처리 방식 제공

### 2025년 초기 버전
- ✅ **성능 최적화**: 비동기 처리, 캐싱, 재시도 메커니즘
- ✅ **AI 분석**: 키워드 분석 및 감정 분석 기능
- ✅ **2025년 디자인**: 글래스모피즘, 네오모피즘 적용
- ✅ **안정성 향상**: 오류 처리 및 복구 메커니즘
- ✅ **사용성 개선**: 반응형 디자인 및 접근성 향상 